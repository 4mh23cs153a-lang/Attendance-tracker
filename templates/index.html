{% extends "base.html" %}

{% block title %}Dashboard - Attendance Tracker{% endblock %}

{% block extra_css %}
<style>
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    
    .stat-card {
        background: white;
        border-left: 4px solid #667eea;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .stat-card h3 {
        color: #666;
        font-size: 0.9em;
        text-transform: uppercase;
        margin-bottom: 10px;
    }
    
    .stat-card .number {
        font-size: 2.5em;
        color: #667eea;
        font-weight: bold;
    }
    
    .stat-card.present .number {
        color: #28a745;
    }
    
    .stat-card.absent .number {
        color: #dc3545;
    }
    
    .stat-card.leave .number {
        color: #ffc107;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-grid">
    <div class="stat-card">
        <h3>Total Students</h3>
        <div class="number">{{ students|length }}</div>
    </div>
    <div class="stat-card present">
        <h3>Present Today</h3>
        <div class="number">{{ today_attendance|selectattr('status', 'equalto', 'Present')|list|length }}</div>
    </div>
    <div class="stat-card absent">
        <h3>Absent Today</h3>
        <div class="number">{{ today_attendance|selectattr('status', 'equalto', 'Absent')|list|length }}</div>
    </div>
    <div class="stat-card leave">
        <h3>Leave Today</h3>
        <div class="number">{{ today_attendance|selectattr('status', 'equalto', 'Leave')|list|length }}</div>
    </div>
</div>

<div class="card">
    <h3>ðŸ“‹ Today's Attendance ({{ today }})</h3>
    {% if today_attendance %}
    <table>
        <thead>
            <tr>
                <th>Roll Number</th>
                <th>Student Name</th>
                <th>Status</th>
                <th>Remarks</th>
            </tr>
        </thead>
        <tbody>
            {% for record in today_attendance %}
            <tr>
                <td>{{ record.roll_number }}</td>
                <td>{{ record.name }}</td>
                <td>
                    <span class="badge {% if record.status == 'Present' %}present{% elif record.status == 'Absent' %}absent{% else %}leave{% endif %}">
                        {{ record.status }}
                    </span>
                </td>
                <td>{{ record.remarks or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #666; padding: 20px; text-align: center;">No attendance records for today yet.</p>
    {% endif %}
    <a href="/attendance" class="btn" style="margin-top: 20px;">Mark Today's Attendance</a>
</div>

<style>
    .badge {
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.9em;
        font-weight: 600;
    }
    
    .badge.present {
        background: #d4edda;
        color: #155724;
    }
    
    .badge.absent {
        background: #f8d7da;
        color: #721c24;
    }
    
    .badge.leave {
        background: #fff3cd;
        color: #856404;
    }
</style>
{% endblock %}
